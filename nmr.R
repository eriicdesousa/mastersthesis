library(edgeR)
x <- read.delim("mouseexpression.txt",row.names="Ensembl")
treat<- factor(c("AN108CO","AN208CO","AN308CO","BN108CA","BN208CA","BN308CA","CN108CH","CN208CH","CN308CH","DN148CO","DN248CO","DN348CO","EN148CA","EN248CA","EN348CA","FN148CH","FN248CH","FN348CH"))
time=factor(c("8","8","8","8","8","8","8","8","8","48","48","48","48","48","48","48","48","48"))
repli=factor(c("1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"))
y <- DGEList(counts=x) 
keep <- rowSums(cpm(y)>1) >= 2 
y <- y[keep, , keep.lib.sizes=FALSE]
y <- calcNormFactors(y) 
#design <- model.matrix((~0+treat))
design <- model.matrix((~0+treat+repli))
y <- estimateDisp(y,design,robust=TRUE)
y$common.dispersion
plotMDS(y)
fit <- glmQLFit(y, design,robust=TRUE) 
#qlf <- glmQLFTest(fit, contrast=c(-1,1,0,0,0,0))
qlf1 <- glmQLFTest(fit, contrast=c(-1,1,0,0,0,0,0,0)) 
summary(decideTests(qlf1))
topTags(qlf1)
qlf2 <- glmQLFTest(fit, contrast=c(-1,0,1,0,0,0,0,0)) 
summary(decideTests(qlf2))
topTags(qlf2)
qlf3 <- glmQLFTest(fit, contrast=c(0,0,0,-1,1,0,0,0)) 
summary(decideTests(qlf3))
topTags(qlf3)
qlf4 <- glmQLFTest(fit, contrast=c(0,0,0,-1,0,1,0,0)) 
summary(decideTests(qlf4))
topTags(qlf4)